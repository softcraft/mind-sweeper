<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <title>MindSweeper</title>
  <link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
  <link rel="stylesheet" href="my.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script src="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
  <script src="my.js"></script>

  <!-- User-generated css -->
  <style>
    
  </style>

  <!-- User-generated js -->
  <script>

    $(function() {
        function pageScript(func) {
            var $context = $("div:jqmData(role='page'):last");
            func($context);
        }

        function createIdea(description) {
          $.post("http://mindsweeper.herokuapp.com/ideas", { description: description })
        }

        function deleteIdea() {
          $.post("http://mindsweeper.herokuapp.com/ideas/sweep")
        }

        function getIdea() {
            $.ajax({
                url: "http://mindsweeper.herokuapp.com/review",
                dataType: 'text',
                success: function(data) {
                    var text = data.split(",")[1].split(":")[1];
                    $("#idea").html(text);
                }
            })
        }
        
        pageScript(function($context){
            getIdea();
            
            $("#ok").click(function() {
                deleteIdea();
                getIdea();
            });
            
            $("#bcapturar").click(function() {
              var description =$("input[id=description_text]").val();
              createIdea(description);
              $("input[id=description_text]").val("");
            });
        });
    });

  </script>
</head>
<body>
  <!-- Captura -->
  <div data-role="page" id="page1">
      <div data-theme="a" data-role="header">
          <h3>
              Capturar
          </h3>
      </div>
      <div data-role="content">
              <div data-role="fieldcontain" id="description_text">
                  <fieldset data-role="controlgroup">
                      <label for="description_text">
                      </label>
                      <input name="description" id="description_text" placeholder="" value=""
                      type="text">
                  </fieldset>
              </div>
              <input id="bcapturar" type="submit" data-icon="plus" data-iconpos="top"
              value="Capturar">
      </div>
      <div data-role="tabbar" data-iconpos="top" data-theme="a">
          <ul>
              <li>
                  <a href="#page1" data-transition="fade" data-theme="" data-icon="plus">
                      Capturar
                  </a>
              </li>
              <li>
                  <a href="#page4" data-transition="fade" data-theme="" data-icon="check">
                      Revisar
                  </a>
              </li>
          </ul>
      </div>
  </div>
  <!-- Revisa -->
  <div data-role="page" id="page4">
      <div data-theme="a" data-role="header">
          <h3>
              Revisar
          </h3>
      </div>
      <div data-role="content">
          <div data-role="fieldcontain" id="revisar_field">
              <fieldset data-role="controlgroup">
                  <label id="idea">
                      No hay ideas
                  </label>
              </fieldset>
          </div>
              <input id="ok" type="submit" value="OK">
      </div>
      <div data-role="tabbar" data-iconpos="top" data-theme="a">
          <ul>
              <li>
                  <a href="#page1" data-transition="fade" data-theme="" data-icon="plus">
                      Capturar
                  </a>
              </li>
              <li>
                  <a href="#page4" data-transition="fade" data-theme="" data-icon="check">
                      Revisar
                  </a>
              </li>
          </ul>
      </div>
  </div>

  
</body>
</html>
